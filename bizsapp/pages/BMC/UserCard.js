import styles from '../../styles/BMCUserCard.module.css';
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faAngleRight, faAngleLeft, faLink } from "@fortawesome/free-solid-svg-icons";
import { faYoutube, faFacebook, faTwitter, faInstagram, faLinkedin } from "@fortawesome/free-brands-svg-icons";
import { useState } from 'react';
import Image from "next/image";
import Link from "next/link";
import Head from 'next/head'
import * as React from "react";
import { ObjectId } from "mongodb";
import { pageURL } from "../../utils/PageURL";

import { Swiper, SwiperSlide } from "swiper/react";

// Import Swiper styles
import "swiper/css";
import "swiper/css/effect-coverflow";
import "swiper/css/pagination";
// import required modules
import { EffectCoverflow, Pagination } from "swiper";

// dbConnect
import { connectToDatabase } from "../../lib/mongodb";



export default function UserCard({ properties, userData }) {
    return (
        <>
            {properties && properties.map(properties => {


                const [active, setActive] = useState(false);


                const [copied, setCopied] = useState(false);
                function copy() {
                    const el = document.createElement("input");
                    el.value = window.location.href;
                    document.body.appendChild(el);
                    document.body.appendChild(el);
                    el.select();
                    document.execCommand("copy");
                    document.body.removeChild(el);
                    setCopied(true);
                }

                const [copiedLocation, setCopiedLocation] = useState(false);
                function copyLocation() {
                    const el = document.createElement("input");
                    el.value = properties.address;
                    document.body.appendChild(el);
                    document.body.appendChild(el);
                    el.select();
                    document.execCommand("copy");
                    document.body.removeChild(el);
                    setCopiedLocation(true);
                }

                return (
                    <>
                        <Head>
                            <title>BMC | Business Management Card</title>
                            <meta name="description" content="Generated by Bizsapp" />
                            <link rel="icon" href="/favicon.ico" />
                            <meta name="msapplication-TileImage" content={properties.brandLogo} />
                            <meta property="og:site_name" content={properties.brandName} />
                            <meta property="og:BMC" content={properties.businessName} />
                            <meta property="og:title Card" content="Business Managment Card" />
                            <meta property="og:image" itemprop="image" content={properties.brandLogo} />

                            <meta property="og:type" content="website" />
                            <meta property="og:image:type" content="image/png" />

                            <meta property="og:image:width" content="300" />
                            <meta property="og:image:height" content="300" />

                            <meta property="og:url" content="https://bizsapp.com/" />
                        </Head>

                        <section className='container-fluid p-0'>
                            <div className={styles.bmc_box}>
                                <div className={styles.flip_card}>
                                    <div className={active ? `${styles.card} ${styles.active}` : styles.card}>
                                        {/* fornt side */}
                                        <div className={`${styles.card__face} ${styles.card__face_front}`}>
                                            <div className={styles.cardBg}>
                                                <img src="/img/ecard/bg.png" alt="cardBg" />
                                            </div>

                                            <div className={styles.cardFrontContent}>
                                            <div className={styles.cardName}>
                                                Business Management Card
                                            </div>

                                            <div className={styles.forntProfileBox}>
                                                <div className={styles.companyLogo}>
                                                    <img src={properties.brandLogo} className="img-fluid" />
                                                </div>
                                                <div className={styles.companyName}>
                                                    <h1>{properties.brandName}</h1>
                                                </div>
                                                <div className={styles.designationName}>
                                                    <span>(Software Developer)</span>
                                                </div>
                                                <div className={styles.descriptionBox}>
                                                    <p>A designation is a description, name, or title that is given to someone or something. Designation is the fact of giving that description, name, or title</p>
                                                </div>
                                            </div>

                                            <div className={styles.catalogBox}>
                                                <div className={styles.catalogTitle}>
                                                    <div>Our Products</div>
                                                </div>
                                                <div className="catalogSlider">
                                                    <Swiper
                                                        effect={"coverflow"}
                                                        grabCursor={true}
                                                        centeredSlides={true}
                                                        slidesPerView={"auto"}
                                                        loop={true}
                                                        pagination={{
                                                            clickable: true,
                                                        }}
                                                        coverflowEffect={{
                                                            rotate: 0,
                                                            stretch: 0,
                                                            depth: 180,
                                                            modifier: 1,
                                                            slideShadows: true,
                                                        }}
                                                        breakpoints={{
                                                            320: {
                                                                spaceBetween: 2
                                                            },
                                                            640: {
                                                                spaceBetween: 5
                                                            },
                                                            768: {
                                                                spaceBetween: 30
                                                            }
                                                        }}
                                                        modules={[EffectCoverflow, Pagination]}
                                                        className="mySwiper"
                                                    >
                                                        <SwiperSlide>
                                                            <div className={styles.catalogImg}>
                                                                <img src='/img/catalog/1.png' alt='catalog_image' className='img-fluid' />
                                                            </div>
                                                            <div className="catalogName">
                                                                    Headphones
                                                            </div>
                                                        </SwiperSlide>
                                                        <SwiperSlide>
                                                            <div className={styles.catalogImg}>
                                                                <img src='/img/catalog/2.png'  alt='catalog_image' className='img-fluid' />
                                                                
                                                            </div>
                                                            <div className="catalogName">
                                                                    Men's Jeans
                                                                </div>
                                                        </SwiperSlide>
                                                        <SwiperSlide>
                                                            <div className={styles.catalogImg}>
                                                                <img src='/img/catalog/3.png' alt='catalog_image' className='img-fluid' />
                                                                <div className="catalogName">
                                                                    Men's Shoes
                                                                </div>
                                                            </div>
                                                        </SwiperSlide>
                                                        <SwiperSlide>
                                                            <div className={styles.catalogImg}>
                                                                <img src='/img/catalog/1.png' alt='catalog_image' className='img-fluid' />
                                                                
                                                            </div>
                                                            <div className="catalogName">
                                                                Headphones
                                                                </div>
                                                        </SwiperSlide>
                                                        <SwiperSlide>
                                                            <div className={styles.catalogImg}>
                                                                <img src='/img/catalog/2.png' alt='catalog_image' className='img-fluid' />
                                                                
                                                            </div>
                                                            <div className="catalogName">
                                                                    Men's Jeans
                                                                </div>
                                                        </SwiperSlide>
                                                        <SwiperSlide>
                                                            <div className={styles.catalogImg}>
                                                                <img src='/img/catalog/3.png' alt='catalog_image' className='img-fluid' />
                                                                
                                                            </div>
                                                            <div className="catalogName">
                                                                    Men's Shoes
                                                                </div>
                                                        </SwiperSlide>
                                                        <SwiperSlide>
                                                            <div className={styles.catalogImg}>
                                                                <img src='/img/catalog/1.png' alt='catalog_image' className='img-fluid' />
                                                                
                                                            </div>
                                                            <div className="catalogName">
                                                                Headphones
                                                                </div>
                                                        </SwiperSlide>
                                                        <SwiperSlide>
                                                            <div className={styles.catalogImg}>
                                                                <img src='/img/catalog/3.png' alt='catalog_image' className='img-fluid' />
                                                                
                                                            </div>
                                                            <div className="catalogName">
                                                                    Men's Shoes
                                                                </div>
                                                        </SwiperSlide>
                                                    </Swiper>
                                                </div>
                                            </div>

                                            <div className={styles.bottomButtonBox}>
                                                <ul>
                                                    <li>
                                                        <div className={styles.iconBox}>
                                                            <img src="/img/catalog/link.png" alt="link" className='img-fluid' />
                                                        </div>
                                                    </li>
                                                    <li>
                                                        <div className={styles.iconBox}>
                                                            <img src="/img/catalog/phone.png" alt="phone" className='img-fluid' />
                                                        </div>
                                                    </li>
                                                    <li>
                                                        <div className={styles.iconBox}>
                                                            <img src="/img/catalog/whatsapp.png" alt="whatsapp" className='img-fluid' />
                                                        </div>
                                                    </li>
                                                    <li>
                                                        <div className={styles.iconBox}>
                                                            <img src="/img/catalog/mail.png" alt="mail" className='img-fluid' />
                                                        </div>
                                                    </li>
                                                    <li>
                                                        <div className={styles.iconBox} onClick={() => setActive(!active)}>
                                                        <img src="/img/catalog/arow.png" alt="arow" className='img-fluid' />
                                                        </div>
                                                    </li>
                                                </ul>
                                            </div>
                                            </div>
                                        </div>
                                        {/* back side */}
                                        <div className={`${styles.card__face} ${styles.card__face_back}`}>
                                            <div className={styles.clickButton} onClick={() => setActive(!active)}>
                                                <FontAwesomeIcon icon={faAngleLeft} />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>


                    </>
                )
            })}
        </>
    )
};


export async function getServerSideProps(context) {

    const id = context.query.id;

    const { db } = await connectToDatabase()

    const data = await db.collection("businesscards").find({ user: ObjectId(id) }).toArray()

    const data2 = await db.collection("users").find({ _id: ObjectId(id) }).toArray()


    const userData = JSON.parse(JSON.stringify(data2));

    const properties = JSON.parse(JSON.stringify(data));

    return {
        props: {
            properties: properties,
            userData: userData
        },
    }


};